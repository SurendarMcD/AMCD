/*!
    SlickNav Responsive Mobile Menu
    (c) 2013 Josh Cope
    licensed under GPL and MIT
*/
(function(e,t,n){var r={
label:"&nbsp;",
duplicate:true,
duration:200,
easingOpen:"swing",
easingClose:"swing",
closedSymbol:"&#9658;",
openedSymbol:"&#9660;",
prependTo:"body",
parentTag:"a",
closeOnClick:false,
allowParentLinks:false},
i="slicknav",
s="slicknav";

e.fn[i]=function(n){




              
              //$("li:last").css( "background-color", "red" );
                                    //alert($('.slicknav_item').child().attr('class'));
                                    //alert($("a.slicknav_item").first().attr('class'));
                                     
                                    
    return this.each(function(){

                        function h(e)
                        {
                         
                                        var t=e.data("menu");
                                        
                                        if(!t)
                                        {
                                            t={};
                                            t.arrow=e.children("."+s+"_arrow");
                                            t.ul=e.next("ul");
                                            t.parent=e.parent();
                                            e.data("menu",t)
                                        
                                        }
                                        
                                        if(e.parent().hasClass(s+"_collapsed")) 
                                        {
                                            t.arrow.html('<img src= "/etc/designs/mcd/accessmcd/g2g/g2g_rwd/g2g_rwd_cyan/images/arrowdown.jpg">');                                        
                                            t.parent.removeClass(s+"_collapsed");
                                            p(t.ul,true)
                                        }
                                        else
                                        {
                                            //alert('test');
                                            t.arrow.html('<img src= "/etc/designs/mcd/accessmcd/g2g/g2g_rwd/g2g_rwd_cyan/images/uparrow.jpg">');
                                            t.parent.addClass(s+"_collapsed");
                                            p(t.ul,true)
                                            
                                        }
                        }
                                   
                        function p(e,t)
                        {
                            
                            var n=v(e);
                            var r=0;
                            
                            if(t)
                            r=o.duration;
                            
                            
                            if(e.hasClass(s+"_hidden"))
                            {
                            
                                
                                //alert('2222'+e.attr('class'));
                                //alert('1111');
                                //alert('6'+$('ul.sub-menu').html());
                                //$('ul.sub-menu').addClass(s+"_hidden");
                                $('.sub-menu').addClass(s+"_hidden");
                                
                                e.removeClass(s+"_hidden");
                                
                                var slickItem = $('.slicknav_hidden').prev().attr('class');
                                
                               
                                $('.slicknav_parent .sub-menu li:last-child').css("border-bottom", "none");
                                
                                if(slickItem.match('slicknav_item'))
                                {
                                    //alert($('.slicknav_hidden').prev().children().attr('class'));
                                    //$('.slicknav_hidden').prev().children().addClass('slicknav_arrow_new');
                                    //var slickArrow = $('.slicknav_hidden').prev().children().hasClass('slicknav_arrow');
                                    
                                    //if($('.slicknav_hidden').prev().children().hasClass('darrow'))
                                    //{                                  
                                        $('.slicknav_hidden').prev().children().html('<img src= "/etc/designs/mcd/accessmcd/g2g/g2g_rwd/g2g_rwd_cyan/images/uparrow.jpg">');
                                    //}
                                }
                                
                                
                                
                                
                                
                                //$('.sub-menu').addClass(s+"_hidden");
                                //$('.sub-menu').css('display','none');
                                //$('.sub-menu').addClass(s+"_hidden");
                                $('.slicknav_parent').addClass('slicknav_collapsed'); 
                                
                                //alert($('.sub-menu').prev().children().attr('class'));
                                //$('.sub-menu').prev().children().html('<img src= "/etc/designs/mcd/accessmcd/g2g/g2g_rwd/g2g_rwd_cyan/images/uparrow.jpg">');
                                //alert($('.slicknav_parent').children('slicknav_item').attr('class'));                
                                e.parent().removeClass("slicknav_collapsed"); 
                                
                                //e.prev().children().html('<img src= "/etc/designs/mcd/accessmcd/g2g/g2g_rwd/g2g_rwd_cyan/images/arrowdown.jpg">');
                                
                                e.slideDown(r,o.easingOpen);                                                                                               
                                e.attr("aria-hidden","false");
                                n.attr("tabindex","0");
                                d(e,false)
                                
                            }
                            else
                            {
                                //alert('closed');
                                //alert('2222'+e.attr('class')); 
                                //alert('7');
                                $('.slicknav_parent').addClass('slicknav_collapsed'); 
                                e.addClass(s+"_hidden");
                                e.slideUp(r,o.easingClose,function()
                                {
                                    e.attr("aria-hidden","true");
                                    n.attr("tabindex","-1");
                                    d(e,true);
                                    e.hide()
                                })
                            }
                        }
                        
                        function d(t,n)
                        {
                            var r=t.children("li").children("ul").not("."+s+"_hidden");
                            
                            if(!n)
                            {
                                r.each(function()
                                    {
                                        var t=e(this);
                                        t.attr("aria-hidden","false");
                                        var r=v(t);
                                        r.attr("tabindex","0");
                                        d(t,n)
                                    })
                            }else
                            {
                                r.each(function()
                                    {
                                        var t=e(this);
                                        t.attr("aria-hidden","true");
                                        var r=v(t);
                                        r.attr("tabindex","-1");
                                        d(t,n)
                                    })
                            }
                        }
                        
                        function v(e)
                        {
                            var t=e.data("menu");
                            
                            if(!t)
                            {
                                t={};
                                var n=e.children("li");
                                var r=n.children("a");
                                t.links=r.add(n.children("."+s+"_item"));
                                e.data("menu",t)
                            }
                            
                            return t.links
                        }
                        
                        function m(t)
                        {
                            if(!t)
                            {    
                                e("."+s+"_item, ."+s+"_btn").css("outline","none")
                                
                            }else{
                            
                                e("."+s+"_item, ."+s+"_btn").css("outline","")
                            }
                        }
                        
                        var i=e(this);
                        var o=e.extend({},r,n);
                        
                        if(o.duplicate)
                        {
                            var u=i.clone();
                            u.removeAttr("id");
                            u.find("*").each(function(t,n){
                                
                                e(n).removeAttr("id")}
                                
                            )
                        }else 
                        
                        var u=i;
                        
                        var a=s+"_icon";
                        
                        if(o.label=="")
                        {
                            a+=" "+s+"_no-text"
                        }
                        
                        if(o.parentTag=="a")
                        {
                            o.parentTag='a href="#"'
                            
                        }
                        
                        u.attr("class",s+"_nav");
                        
                        var f=e('<div class="'+s+'_menu"></div>');
                        
                        var l=e("<"+o.parentTag+' aria-haspopup="true" tabindex="0" class="'+s+'_btn"><span class="'+a+'"><span class="'+s+'_icon-bar"></span><span class="'+s+'_icon-bar"></span><span class="'+s+'_icon-bar"></span></span></a>');
                        
                        e(f).append(l);
                        e(o.prependTo).prepend(f);
                        f.append(u);
                        
                        var c=u.find("li");
                        e(c).each(
                            function()
                            {
                                var t=e(this);
                                data={};
                                data.children=t.children("ul").attr("role","menu");
                                t.data("menu",data);
                                
                                if(data.children.length>0)
                                {
                                    var n=t.contents();
                                    var r=[];
                                    e(n).each(function(){
                                        if(!e(this).is("ul"))
                                        {
                                            r.push(this)
                                            
                                        }
                                        else
                                        {
                                            return false
                                        }
                                    });
                                    
                                    //alert("<"+o.parentTag+' role="menuitem" aria-haspopup="true" tabindex="-1" class="'+s+'_item"/>');
                                    
                                    var i=e(r).wrapAll("<"+o.parentTag+' role="menuitem" aria-haspopup="true" tabindex="-1" class="'+s+'_item"/>').parent();
                                    //alert(i.children(".topnavitem").html());
                                   // var indexOfSpan = (i.children(".topnavitem").html()).indexOf('<span class="darrow">');                               
                                    //var menuText = (i.children(".topnavitem").html()).substring(0,indexOfSpan);

                                   // i.html(menuText);
                                    //var menuLink = i.children(".topnavitem").attr("href");
                                    //i.attr("href",menuLink);
                                    //i.children(".topnavitem").css("display","none");

                                    t.addClass(s+"_collapsed");
                                    t.addClass(s+"_parent");
                                    //e(r).last().after('<span class="'+s+'_arrow">'+ o.closedSymbol+"</span>")
                                    e(r).parent().html(e(r).text()+'<span class="'+s+'_arrow"><img src= "/etc/designs/mcd/accessmcd/g2g/g2g_rwd/g2g_rwd_cyan/images/uparrow.jpg"></span>');
                                    //e(r).last().after('<span class="'+s+'_arrow"><img src= "/etc/designs/mcd/accessmcd/g2g/g2g_rwd/g2g_rwd_cyan/images/uparrow.jpg"></span>')
                                   
                                    //alert(e(r).text());
                                    //alert($("a.slicknav_item a:first-child").html());
                                    //e(r).parent().html('TEST');
                                    e(r).remove();
                                    
                                    //$("a.slicknav_item a:first-child").remove();
                                }
                                else if(t.children().length==0)
                                {
                                    t.addClass(s+"_txtnode")
                                }
                                    t.children("a").attr("role","menuitem").click(function()
                                    {
                                        if(o.closeOnClick)e(l).click()
                                    })
                            });
                            
                            e(c).each(
                                function(){
                                        
                                        var t=e(this).data("menu");
                                        p(t.children,false)
                                        
                                });
                            
                            p(u,false);
                            
                            u.attr("role","menu");
                            
                            e(t).mousedown(function()
                            
                            {
                                m(false)
                                
                            });
                            
                            e(t).keyup(function()
                            {
                                m(true)
                                
                            });
                            
                            e(l).click(function(e) 
                            {
                            

                                
                                if($('.RWDNEW').hasClass('rwdnewclass'))
                                {                                    
                                    $('.RWDNEW').removeClass('rwdnewclass');                                    
                                    $('#pagecontentwrapper').animate({left:'0'});
                                    $('.slicknav_background').remove();
                                    //$('.slicknav_menu').remove();
                                    
                                }
                                else
                                {                                       
                                    $('.RWDNEW').addClass('rwdnewclass');                                                                                                             
                                    $('#pagecontentwrapper').css('position','relative');
                                    $('#pagecontentwrapper').animate({left:'50%'});
                                   // $('#pagecontentwrapper').css('background-image','url("/etc/designs/mcd/accessmcd/corelibs/images/jquery/mcdcolorbox/overlay_bg.png")');                            
                                   // $('#pagecontentwrapper').css('z-index','9999');
                                   $('#pagecontentwrapper').prepend('<div class="slicknav_background"></div>');   
                                   //$('.slicknav_menu').append('<ul class="slicknav_right"></ul>');     
                                   //$('.slicknav_right').css('background','#000');                                                             
                                }
                                /*
                                    if($('body').children('div').hasClass('slicknav_background'))
                                    {
                                        $('.slicknav_background').remove()\\\\\]]]]]]NEW').removeClass('rwdnewclass');
                                    }
                                    else
                                    {    
                                       $('body').prepend('<div class="slicknav_background"></div>');
                                       $('.RWDNEW').addClass('rwdnewclass');
                                       //$('.RWDNEW').addClass('position','absolute');
                                       //$('.RWDNEW').css('z-index','9999');
                                       //$('.RWDNEW').css('top','0');
                                       //$('.slicknav_menu').css('min-width','245px');
                                        
                                                                            
                                    }
                                */    
                                
                                                            
                                e.preventDefault();
                                p(u,true)
                                
                            });
                            
                            u.on("click","."+s+"_item",function(t){t.preventDefault();h(e(this))});
                            
                            e(l).keydown(function(e)
                            {
                                var t=e||event;
                                
                                if(t.keyCode==13)
                                {
                                    e.preventDefault();
                                    p(u,true)
                                    
                                }
                            });
                            
                            u.on("keydown","."+s+"_item",function(t)
                            {
                                var n=t||event;
                                
                                if(n.keyCode==13)
                                {    
                                    t.preventDefault();
                                    h(e(t.target))
                                }
                            });
                            
                            if(o.allowParentLinks)
                            {
                                e("."+s+"_item a").click(function(e)
                                {
                                    e.stopImmediatePropagation()
                                }
                                )
                            }
                })
            }
        })(jQuery,document,window)              